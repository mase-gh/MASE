#Malware and Proliferation

Trey Herr — trey_herr@hks.harvard.edu
Amy Armbrust — amy@nullhybrid.net  

##Executive Summary
The goal of this project is to understand proliferation of malicious software components between state and non-state actors. To accomplish this, the endeavor builds from two subsidiary components – sophistication/lineage and markets. Sophistication/Lineage would provide a consistent means to categorize and describe the components being proliferated while Markets would paint a picture of the ecosystem underlying their exchange and use. 

####Sophistication/Lineage
Developing a large corpus of malware samples, this project will attempt to develop and update an index of sophistication for malware. Besides the immediate application of tracking the year over year evolution of malware’s capabilities and the attendant skill gap between various groups, this index will also be useful in sorting criminal and state organizations into a typology predicated on capability. This same dataset can be used to trace the grouping of samples into families and these family’s change over time. 

- *Sophistication:*
   Develop an evolving sophistication index for malware based on state and non-state samples. Built on a mix of architectural and behavioral characteristics based on previous work and some targeted reverse engineering effort in conjunction with automated analysis of object code. 

- *Lineage Tracing:*
   Central to each of these projects is a common dataset mapping the features present in and evolution of malicious software families over time. Collecting a set of malware samples, grouped into families, and evaluating them to map evolution across three components – propagation methods, payloads, and exploits. 

####Malware Market
The ecosystem most impacted by counter-proliferation efforts is the information security industry, in all of its various shades. Modeling this marketplace of both malicious and well intentioned software development and use provides the structural substrate on which to understand changes like the Wassenaar export controls and analyze the impact of proposals like Dan Geer’s to have states buy all vulnerabilities. This project would model the structure of the malicious software markets, classify major actor types, and profile their decision making processes. Using this information, it would then model major market behaviors such as the sources of demand for malware components.

####Proliferation
Putting this work together produces a dynamic model on which to propose and test differing approaches for counter-proliferation of malicious software, the first such empirical model of its kind. This could be used to map the flow of capabilities between different groups over time using the previously developed sophistication index as a “tracer” with the market model to describe a network through which malicious software components flow.

This project will contribute to a more complete understanding of the capabilities of threat actors in the information security space, advance the state of the art in malicious market research, and contribute to an evaluation of policy proposals relating to export control and malware proliferation.  Each of these sub-projects (Sophistication, Lineage, and Markets) holds independent scholarly value and addresses gaps in existing information security research. 
Malware doesn’t exist in a vacuum.  It is a product of conscious efforts to design and deploy tools against targets on the Internet and has grown more sophisticated and pervasive in the past decade. There are growing signs of collaboration between groups developing malicious software components and evidence of a developed marketplace for goods like exploits.

Understanding not only these components but the marketplace they exist in and the changes which take place in both over time is crucial to advancing information security research as well as informing effective policy proposals. This project proposes a holistic framework for the malware markets, built around a set of decision theoretic models validated through real world data, paired with an ongoing effort to classify the sophistication of malicious software, trace the evolution of malware families, and map the exchange of capabilities between families of code. This framework must go beyond the limited and occasionally sensational treatments seen thus far to capture the full range of detail in the market to inform a more complete understanding of the types of threat actors and their decisions to add or subtract capabilities. In addition to this market model and evolving sophistication index, the project will help to offer a set of recommendations on how to mitigate threats through new defensive behavior or policy interventions.

##Project Details
####Sophistication
What makes malware sophisticated and how can researchers distinguish between high and low capability groups based on analysis of their code? The development of malicious software tends toward variation in both function and sophistication but while tools to determine the intent and operation of malware are legion, analytic means by which to differentiate based on author skill or product complexity are rare. Building this sort of tool, a sophistication scale, is an evolving task but would allow for more refined attribution and tracing the diffusion of capabilities between groups across multiple axes, vertically (between high and low skill) and horizontally (across groups with different preferred target sets). 

Looking particularly at the relationship between state and non-state groups - the difference in code authorship styles is typically described in vague terms, contributing to the inaccurate confirmation bias of many that states simply 'do it better'. State samples represent an aberrant spike in an otherwise slow evolution over time. The implication that well resourced political entities are an increasingly common source of malicious software samples is potentially significant. This effort will move beyond a simple "sophisticated/unsophisticated" dichotomy and advance previous work by focusing on common functional characteristics of malicious code and comparing the work of state and non-state actors to better understand what depends on the unique operational demands of each. Breaking down these down into architectural and behavioral features, we can build a multi-dimensional tool to categorize different samples as well as show the rate of evolution and the difference in techniques between threat groups. A shorthand for these samples, a more comprehensive means of classifying them, would be generally useful for analysts and will act as a “tracer” element for this project, tracking the movement of capabilities between actors.

####Lineage Tracing
At the center of the project is a database of common malware families which captures samples at multiple levels of sophistication, from both criminal and state groups. This work will leverage a collection of open source tools, for example ILINE developed at Carnegie Mellon for automated lineage tracing among different malware samples, and a growing community of relevant researchersv. Using these resources, we can trace the relationship between malicious software samples, grouping them into families and tracing common components such as payloads and exploits. This process, known as phylogenetics, is based in the study of evolutionary relationships in biology which examine the change in a set of organisms over time as they diversify into families and sub-families. As such, the bioinformatics research community has developed an array of lexical and statistical tools which have been adapted and improved upon for software analysis. 

The resulting work, malware phylogenetics, applies these tools to the creation and updating of malicious code. Large code bases or “families”, like the Zeus banking malware, have evolved over years of use with constant iteration to add obfuscation and swap out new exploits as well as less frequent change to payload modules and propagation methods. This database will take related samples and use a consistent coding framework to guide analysis and record features like execution paths, the characteristics of exploits employed, and relevant command and control (C2) infrastructure. Included in the analysis will be at least a dozen distinct state and non-state authored malware families. 

####Malware Market
A challenge within information security in general and malware markets in particular is the lack of holistic understanding of the malware ecosystem. Individual scholars have produced insight into certain  interactions and elements of the marketplace but we lack the ability to understand how they fit together. This attempts to advance the state of the art by building a framework around the entire lifecycle of malware production and acquisition, an approach made holistic by its inclusion of all major actors and decision points.  The use of a modular framework to track malware evolution and trace development of different features builds on previous work that established the market-like qualities of certain interactions between criminal groups using malware.

A gap in existing work on malware lineage is connecting changes in code to threat actor’s behavior and decision making. As groups evolve code, are their changes intended to shift the possible target set, add new features, in reaction to competitors in a market, a response to compromised infrastructure, or any one of a number of other possibilities? To begin to answer these questions, the project will build a map of the malicious software markets, assemble profiles for a range of different prototypical actors, and model their decision making processes. Using this insight, we can begin to establish changes in target selection and malware construction as a product of purposeful decision making on the part of threat groups. There is immediate use for such a product, where trends in a particular group’s target selection, midsize retailers for instance, could inform an information security vendor’s portfolio of similarly positioned and sized companies.  Linked with a technical analysis of the evolution of particular malware families, this project will be able to map out the process and choices underlying the development and deployment of malware as well as modelling the larger structure of this marketplace. 

####Proliferation
How do capabilities diffuse between groups and how can we use patterns and pairings of code reuse or exchange to profile unknown threat actor relationships? Using the malware database employed to trace the lineage of different families of code as a baseline and the evolving sophistication index, we can track particular malware components between different threat actors. Understanding the varying sophistication of code produced by different actors provides an empirical basis to trace code’s transfer between organizations. Modeling this diffusion can help systematize our understanding of the proliferation problem for malware, where techniques are unintentionally passed on to others. It can also be used to identify where groups are collaborating or, in certain instances, where states are devolving capabilities to particular proxy actors. Looking at this issue of state use in particular, studying the diffusion of malware components and capabilities proposes a new basis on which to assess the cost of state authored malware use, in terms of where that code is then reused against firms and individuals. 
